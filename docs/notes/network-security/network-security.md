# 网络安全笔记

## 什么时候网络安全

机密性: 只有发送方和预订的接收方能否理解传

输的报文内容
* 发送方加密报文
* 接收方解密报文

认证: 发送方和接收方需要确认对方的身份

报文完整性: 发送方、接受方需要确认报文在传，输的过程中或者事后没有被改变

访问控制和服务的可用性: 服务可以接入以及对，用户而言是可用的

## 加密原理

对称加密：发送方与接收方密钥相同

非对称加密（公开密钥）：发送方使用接收方的公钥进行加密，接收方使用自己的私钥进行解密

### 对称密钥加密

最原始是的加密方式：替换密码

单码替换密码: 将一个字母替换成另外一个字母

下面的例子就是 26 的阶乘，早起没计算机的情况下，也需要花不少的时间

明文: abcdefghijklmnopqrstuvwxyz

密文: mnbvcxzasdfghjklpoiuytrewq

对称加密因为是发送/接收方用的同一个密钥加密解密，这样就会造成一个 key 如何分发的问题

* 对称加密的早期标准（US 加密标准）DES，加密方式是把明文分成 64bit 的块，在对每一块加密，64bit 成组加密。DES 并不安全，目前的计算机可以很快的计算出 key。

* 新的对称加密标准 AES，新的对称 密钥NIST标准(Nov. 2001) 用于替换 DES。数据 128bit 成组加密。穷尽法解密如果使用1秒钟破解 DES, 需要花149万亿年破解AES

### 公开密钥加密

发送方和接收方不用共享密钥，一个实体的公钥公之于众，可以直接去下载个公钥，私钥只有自己知道。通过公钥加密，在通过私钥解密。

![Image text](./image/1645776922(1).png)

#### RAS 公开密钥算法

RSA算法是现今使用最广泛的公钥密钥算法

![Image text](./image/1645777149(1).png)

![Image text](./image/1645777193(1).png)

在数学界寻找出最大的质数是很困难的，在计算机加密学应用的这一特性，加大解密的难度。

![Image text](./image/1645777520(1).png)

## 认证

在网络中，如何鉴别端到端，就是一个实体经过计算机网络向另一个实体证明 其身份的过程。在网络我如何想别人证明我就是我。

### 鉴别协议 ap1.0 

在网络中 Bod 看不到 Alice，传输信息过程中完全有可能被劫持，Trudy 可以声称自己是 Alice。

### 鉴别协议 ap2.0 

在 1.0 的基础上次我 Alice 在给 Bod 的数据报中包括自己的 IP 地址来证明自己是 Alice，同样 Trudy可以生成一个分组，包括伪造的 Alice 的地址

### 鉴别协议 ap3.0 

在 2.0 的基础上 Alice 明文传输自己的密码给对方，来证明自己，重放攻击playback attack: Trudy记录 Alice 的分组，事后向Bob重放。

### 鉴别协议 ap3.1 

在 3.0 的基础上 Alice 说 “I am Alice” ，而且传送她的加密之后的密码来证明。记录，重放仍然有效

### 鉴别协议 ap4.0

避免重放攻击，Nonce: 一生只用一次的整数 (R)。为了证明Alice的活跃性, Bob发送给Alice一个nonce, R. Alice 必须返回加密之后的R，使用双方约定好的key

### 鉴别协议 ap5.0

4.0 的问题是需要双方共享同一套对称密钥。对称密钥如何安全的方式共享给双方了。考虑可不可用公开密钥的方式了，使用nonce,公开密钥加密技术，Alice 用自己的私钥加密 nonce，Bod 用 Alice 的公钥来解密。确定 nonce 没问题就认证成功。

同样 ap5.0 也不是完全完美的，也存在中间攻击，Trudy 可以在中间截获认证信息然后篡改。

## 报文完整性

### 数字签名

数字签名类比于手写签名，发送方（Alice）数字签署文件，前提文件（报文）是她拥有的。并且数字签名有可验证性，不可伪造性，不可抵赖性。

* 谁签署：接收方 (Bob)可以向他人证明是 Alice, 而不是其他人签署了这个文件 (包括Bob)
* 签署了什么：这份文件（报文），而不是其它文件

简单的对ｍ的数字签名：

Alice 使用他自己的私钥对m进行了签署 ，创建数字签名 KB-(m)

### 报文摘要

对长报文进行公开密钥加密算法的实施需要耗费大量的时间。那如何得到一个固定长度，容易计算的签名。对 m 使用散列函数H，获得固定长度的报文摘要H(m)。

散列函数的特性：
* 多对1
* 结果固定长度
* 给定一个报文摘要x, 反向计算出原报文在计算上是不可行的 x = H(m)

数字签名 = 对报文摘要进行数字签署

对报文摘要进行数字签署就是对报文的数字签名。通过签名一盒牛奶来证明我签名的是一车牛奶。

![Image text](./image/1645860810(1).png)

## 密钥分发与证书

对于对称密钥加密来说如何分发共享密钥给双方是个问题，对于公开密钥加密来说如何获得公信力的公钥也是个问题。介于此，就是需要一个可信赖的中介机构。

### KDC（Key Distribution Center）

对称密钥加密需要的中介机构 KDC，发送/接收方都都需要分享对称式密钥，KDC: 服务器和每一个注册用户都分享一个对称式的密钥(many users)，Alice, Bob在和KDC通信的时候，知道他们自己的对称式密钥 KA-KDC KB-KDC.

![Image text](./image/1645863352(1).png)

### CA（Certification Authorities）

公开密钥加密的中介机构 CA，每个计算机实体在 CA 哪里注册他的公钥，计算机实体提供给 CA 自己的身份证据。CA 创建一个证书，捆绑了实体信息和他的公钥.并且CA是直接的私钥的方式签名了 注册实体与他公钥的关系。

当Alice需要拿到Bob公钥，获得Bob的证书certificate (从Bob或者其他地方)，对Bob的证书，使用CA的公钥来验证

## 各个层次的网络安全

### SSL（Secure sockets layer）


## 防火墙

将组织内部网络和互联网络隔离开来，按照规则

### 分组过滤

内部网络通过配置防火墙的路由器连接到互联网上
 路由器对分组逐个过滤，根据以下规则来决定转发
还是丢弃:  源IP地址,目标IP地址  TCP/UDP源和目标端口  ICMP报文类别  TCP SYN 和ACK bits
