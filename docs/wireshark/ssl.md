# Wireshark实验：探究SSL (Page437)

1. 对于前 8 个以太网帧，请分别指出每一个帧的来源（客户端和服务器），确定每个帧包含的 SSL 记录的数量，并且列出包含 SSL 记录的类型。绘制客
户端和服务器含有箭头指向的时序图。

|  序号   | 帧序号  | 来源 | 数量 | 类型 |
|  ----  | ----  | ----  | ----  | ----  |
| 1  | 106 | 128.238.38.162 | 1 | SSLv2 |
| 2  | 108 | 216.75.194.220 | 1 | SSLv3 |
| 3  | 111 | 128.238.38.162 | 1 | SSLv3 |
| 4  | 112 | 216.75.194.220 | 1 | SSLv3 |
| 5  | 113 | 128.238.38.162 | 1 | SSLv3 |
| 6  | 114 | 216.75.194.220 | 1 | SSLv3 |
| 7  | 122 | 128.238.38.162 | 1 | SSLv3 |
| 8  | 149 | 128.238.38.162 | 1 | SSLv3 |

2. 每个 SSL 记录都以相同的三个字段（可能具有不同的值）开头。 其中一个字段是“内容类型”，长度为一个字节。 请列出所有三个字段及其长度。

Content Type: Handshake (22)

[Version: SSL 2.0 (0x0002)]

Length: 76

3. 展开 ClientHello 记录（如果您的跟踪包含多个 ClientHello 记录，请展开包含第一个记录的以太网帧），内容类型的值是多少？

Handshake (22)

4. ClientHello 记录是否包含随机数（也称为“挑战码”（ challenge））？ 如果是这样，十六进制的挑战码值是多少？

Random: 42dbf0c2033de6c8af29184c919a336821965ccec631bf56181b19381cdc3049

5. ClientHello 记录是否通知了它所支持密码加密套件（suite）？如果是这样，请在第一个密码套件， 分别指出非对称密钥加密算法，对称密钥加密算
法，哈希算法分别都是什么？

非对称加密算法 rsa, 对称加密算法 rc4, 哈希算法 md5

6. 找到 ServerHello SSL 记录。 此记录是否指定了之前的密码套件之一？ 选择的密码套件中有哪些算法？

Cipher Suite: TLS_RSA_WITH_RC4_128_MD5 (0x0004)

7. 此记录是否包含随机数？如过有，它有多长？SSL 中客户端和服务器段随机数用来干什么？

有随机数，长度为 32byte.多次随机数提供对未来加密的安全性

8. 此记录是否包含会话 ID？ 会话 ID 的目的是什么？

有，该会话 ID 用以一定时间内端口连接快速恢复连接过程。当然也可以不使用。

9. 此记录是否包含证书，或者证书是否包含在单独的记录中。 证书是否适合一个单独的以太网帧传输？

没有，下一个以太网帧有证书，理论说一个以太网帧可以承载多个 SSL(TLS)协议，因此一个以太网帧可以承载多个证书

10. 找到客户端密钥交换记录。 此记录是否包含前主密钥(pre-master secret)？这个前主密钥用于什么？ 前主密钥加密了吗？ 如果是这样，为什么？ 加密的前主密钥有多长？

包含前主密钥，长度 32Byte

11. 编码改变记录目的是什么？在您的跟踪中本记录有多少字节

告诉服务器我已经计算好加密密钥

12. 在加密的握手记录中，什么是加密的？ 为什么？

